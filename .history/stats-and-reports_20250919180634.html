<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>İstatistikler ve Raporlar</title>

  <!-- Yazı tipi -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

  <!-- Masaüstü sayfa stilleri -->
  <link rel="stylesheet" href="css/stats-and-reports.css">

  <!-- Ortak rail (mobil/desktop uyumlu) -->
  <link rel="stylesheet" href="css/rail_mobile.css">

  <!-- Bu sayfanın mobil ekleri -->
  <link rel="stylesheet" href="css/mobile_stats-and-reports.css">

  <!-- Bu sayfada profil butonu görünmesin -->
  <style>
    #rail-mount .avatar-btn{display:none!important;}
  </style>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body class="has-rail">

  <!-- rail bar mount (checkout.html ile aynı) -->
  <div id="rail-mount" aria-hidden="true"></div>

  <!-- SAYFA BAŞI -->
  <div class="wrap">
    <div class="header">
      <div class="title">İstatistikler ve raporlar</div>
      <div class="period">
        <button class="btn btn-ghost" id="prevBtn">‹</button>
        <button class="btn" id="monthBtn"><b></b></button>
        <button class="btn btn-ghost" id="nextBtn">›</button>
      </div>
    </div>

    <nav class="tabs" aria-label="Sekmeler">
      <a class="tab" data-tab="dashboard" href="#dashboard">Panel</a>
      <a class="tab" data-tab="appointments" href="#appointments">Randevular</a>
      <a class="tab" data-tab="revenue" href="#revenue">Gelir</a>
      <a class="tab" data-tab="staff" href="#staff">Personel</a>
    </nav>

    <!-- PANEL -->
    <section id="dashboard">
      <div class="grid">
        <div>
          <section class="card panel">
            <div class="card-body">
              <div class="card-title">Randevular &amp; Doluluk <span class="muted">— tahmin</span></div>
              <canvas id="appointmentsChart" height="120" aria-label="Randevular grafiği"></canvas>
              <div class="kpis" style="margin-top:12px">
                <div class="kpi"><b>Randevu</b><span class="green"></span><div class="muted"></div></div>
                <div class="kpi"><b>Rezerve süre</b><span></span><div class="muted"></div></div>
                <div class="kpi"><b>Tamamlanan</b><span></span><div class="muted"></div></div>
              </div>
            </div>
          </section>

          <section class="card panel">
            <div class="card-body">
              <div class="card-title">Gelir <span class="muted">— tahmin</span></div>
              <canvas id="revenueChart" height="120" aria-label="Gelir grafiği"></canvas>
            </div>
          </section>
        </div>

        <aside class="right">
          <div class="small">
            <div class="mini">
              <h4>Randevular</h4>
              <div class="row"><span>Tamamlanan</span><b></b></div>
              <div class="row"><span>Gel(e)meyen</span><b></b></div>
              <div class="row"><span>İptal</span><b></b></div>
            </div>

            <div class="mini">
              <h4>Gelir <span class="chip"></span></h4>
              <div class="row"><span>Hizmetler</span><b></b></div>
              <div class="row"><span>Bahşiş</span><b></b></div>
              <div class="row"><span>Ürünler</span><b></b></div>
              <div class="row"><span>Üyelikler</span><b></b></div>
              <hr style="border:none;border-top:1px solid var(--border);margin:8px 0">
              <div class="row"><span><b>Toplam</b></span><b class="blue"></b></div>
            </div>
          </div>
        </aside>
      </div>
    </section>

    <!-- RANDEVULAR -->
    <section id="appointments" hidden>
      <div id="app-main">
        <div class="grid">
          <div>
            <section class="card panel">
              <div class="card-body">
                <div class="card-title">Randevular &amp; Doluluk <span class="muted">— tahmin</span></div>
                <canvas id="appChart2" height="120"></canvas>

                <div style="margin:16px 0 10px; font-weight:600; font-size:13px;">Öne çıkanlar</div>
                <div class="barline"></div>

                <table class="table" style="margin-top:10px;">
                  <thead>
                    <tr><th>Durum</th><th>Adet</th><th>Yüzde</th><th>Tutar</th></tr>
                  </thead>
                  <tbody></tbody>
                </table>

                <div style="margin:16px 0 6px; font-weight:600; font-size:13px;">İlk 10 hizmet</div>
                <table class="table">
                  <thead><tr><th>Hizmet</th><th>Randevu</th><th>Tutar</th></tr></thead>
                  <tbody></tbody>
                </table>

                <div style="margin:16px 0 6px; font-weight:600; font-size:13px;">İlk 10 eklenti</div>
                <div class="muted" style="padding:16px; border:1px dashed var(--border); border-radius:10px; text-align:center;">Gösterilecek sonuç yok</div>
              </div>
            </section>
          </div>

          <aside class="right">
            <div class="mini">
              <h4>Raporlar</h4>
              <div class="row" data-goto="app-summary"><span>Randevu özeti</span><span>›</span></div>
              <div class="row" data-goto="app-list"><span>Randevu listesi</span><span>›</span></div>
            </div>
          </aside>
        </div>
      </div>

      <!-- ÖZET -->
      <div id="app-summary" hidden>
        <div class="grid">
          <div>
            <section class="card panel">
              <div class="card-body">
                <div class="subheader"><button class="btn btn-ghost" id="back-from-summary">‹ Geri</button><div class="title-sm">Randevu özeti</div></div>

                <div class="card-title" style="margin-top:6px;">Durum özeti</div>
                <table class="table">
                  <thead>
                    <tr><th>Durum</th><th>Adet</th><th>%</th><th>Süre</th><th>Hizmet Tutarı</th><th>Eklenti Tutarı</th><th>Gelir</th></tr>
                  </thead>
                  <tbody></tbody>
                </table>

                <div class="card-title" style="margin-top:18px;">Zaman kullanımı</div>
                <table class="table">
                  <thead><tr><th>Kalem</th><th>Saat</th><th>%</th></tr></thead>
                  <tbody></tbody>
                </table>

                <div class="card-title" style="margin-top:18px;">En iyi günler</div>
                <table class="table">
                  <thead><tr><th>Gün</th><th>Süre</th><th>%</th></tr></thead>
                  <tbody></tbody>
                </table>

                <div class="card-title" style="margin-top:18px;">En iyi saatler</div>
                <table class="table">
                  <thead><tr><th>Saat Aralığı</th><th>Randevu</th><th>Toplam süre</th></tr></thead>
                  <tbody></tbody>
                </table>
              </div>
            </section>
          </div>

          <aside class="right">
            <div class="mini">
              <h4>Raporlar</h4>
              <div class="row" data-goto="app-summary"><span>Randevu özeti</span><span>›</span></div>
              <div class="row" data-goto="app-list"><span>Randevu listesi</span><span>›</span></div>
            </div>
          </aside>
        </div>
      </div>

      <!-- LİSTE -->
      <div id="app-list" hidden>
        <div class="grid">
          <div>
            <section class="card panel">
              <div class="card-body">
                <div class="subheader"><button class="btn btn-ghost" id="back-from-list">‹ Geri</button><div class="title-sm">Randevu listesi</div></div>

                <table class="table" style="margin-top:6px;">
                  <thead>
                    <tr>
                      <th>Tarih</th><th>Saat</th><th>Müşteri</th><th>Hizmet</th><th>Personel</th><th>Süre</th><th>Tutar</th><th>Durum</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
            </section>
          </div>

          <aside class="right">
            <div class="mini">
              <h4>Raporlar</h4>
              <div class="row" data-goto="app-summary"><span>Randevu özeti</span><span>›</span></div>
              <div class="row" data-goto="app-list"><span>Randevu listesi</span><span>›</span></div>
            </div>
          </aside>
        </div>
      </div>
    </section>

    <!-- GELİR -->
    <section id="revenue" hidden>
      <!-- Ana görünüm -->
      <div id="rev-main">
        <div class="grid">
          <div>
            <!-- Üst özetler -->
            <section class="card panel">
              <div class="card-body" style="display:grid; grid-template-columns:1fr 1fr; gap:16px;">
                <div class="mini" style="margin:0;">
                  <div class="muted" style="font-weight:600;">TOPLAM GELİR</div>
                  <div style="font-size:22px; font-weight:800; margin-top:6px;"></div>
                </div>
                <div class="mini" style="margin:0;">
                  <div class="muted" style="font-weight:600;">TOPLAM RANDEVU</div>
                  <div style="font-size:22px; font-weight:800; margin-top:6px;"></div>
                </div>
              </div>
            </section>

            <!-- Gelir grafiği -->
            <section class="card panel">
              <div class="card-body">
                <div class="card-title">Gelir <span class="muted">— tahmin</span></div>
                <canvas id="revenueChartPage" height="120"></canvas>
              </div>
            </section>

            <!-- Türe göre gelir -->
            <section class="card panel">
              <div class="card-body">
                <div class="card-title">Türe göre toplam gelir</div>
                <table class="table" style="margin-top:12px;">
                  <thead><tr><th>Kalem</th><th>%</th><th>Gelir</th></tr></thead>
                  <tbody></tbody>
                </table>
              </div>
            </section>
          </div>

          <aside class="right">
            <div class="mini">
              <h4>Raporlar</h4>
              <div class="row" id="go-sales-by-services"><span>Hizmete göre satışlar</span><span>›</span></div>
            </div>
          </aside>
        </div>
      </div>

      <!-- Hizmete göre satışlar raporu -->
      <div id="rev-services" hidden>
        <section class="card panel">
          <div class="card-body">
            <div class="subheader">
              <button class="btn btn-ghost" id="back-from-rev-services">‹ Geri</button>
              <div class="title-sm">Hizmete göre satışlar</div>
            </div>

            <table class="table" style="margin-top:6px;">
              <thead>
                <tr>
                  <th style="width:160px">Kategori</th>
                  <th>Tarih &amp; Saat</th>
                  <th>Rez. ID</th>
                  <th>Müşteri</th>
                  <th>Süre</th>
                  <th>Hizmet tutarı</th>
                  <th>Eklenti</th>
                  <th>Net</th>
                  <th>İnd.</th>
                  <th>Vergi</th>
                  <th>Bahşiş</th>
                  <th>Toplam</th>
                  <th>Durum</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>

            <div class="card-title" style="margin-top:18px;">Hizmet kategorileri özeti</div>
            <table class="table">
              <thead>
                <tr><th>Kategori</th><th>Adet</th><th>Net</th><th>İnd.</th><th>Vergi</th><th>Bahşiş</th><th>Toplam</th></tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </section>
      </div>
    </section>

    <!-- PERSONEL -->
    <section id="staff" hidden>
      <div class="grid--single">
        <section class="card panel">
          <div class="card-body">
            <div class="card-title">Gelire göre ilk 10 personel</div>
            <table class="table">
              <thead>
                <tr>
                  <th>Personel</th><th>Randevu</th><th>Hizmet</th><th>Ürün</th><th>Hediye Kartı</th><th>Paket</th><th>Üyelik</th><th>Toplam Gelir</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </section>

        <section class="card panel">
          <div class="card-body">
            <div class="card-title">Komisyona göre ilk 10</div>
            <table class="table">
              <thead><tr><th>Personel</th><th>Randevu</th><th>Toplam Gelir</th><th>Komisyon</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </section>

        <section class="card panel">
          <div class="card-body">
            <div class="card-title">Personel başına doluluk</div>
            <table class="table">
              <thead><tr><th>Personel</th><th>Doluluk</th><th>Ziyaret Süresi</th><th>Çalışma Saati</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </section>
      </div>
    </section>
  </div>

  <!-- === AY SEÇİCİ MODAL === -->
  <div class="overlay" id="monthOverlay" hidden>
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="monthTitle">
      <div class="m-head">
        <div class="m-nav">
          <button class="circle" id="yearPrev" aria-label="Önceki yıl">‹</button>
          <button class="circle" id="yearNext" aria-label="Sonraki yıl">›</button>
        </div>
        <b id="monthTitle"></b>
      </div>
      <div class="m-grid" id="monthGrid"></div>
      <div class="m-foot">
        <button class="btn btn-ghost" id="monthClear">Temizle</button>
        <button class="btn" id="monthOk">Tamam</button>
      </div>
    </div>
  </div>

  <!-- Switch Business Modal (ortak) -->
  <div class="bm-overlay" id="bmOverlay"></div>
  <div class="bm-modal" id="bmModal" aria-hidden="true">
    <div class="bm-box" role="dialog" aria-modal="true" aria-labelledby="bmTitle">
      <div class="bm-head">
        <h3 id="bmTitle">Switch Business</h3>
        <button class="bm-x" id="bmClose" title="Kapat">
          <svg viewBox="0 0 24 24" fill="none" width="18" height="18"><path d="M6 6l12 12M18 6 6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </button>
      </div>
      <div class="bm-body">
        <div class="bm-search">
          <svg viewBox="0 0 24 24" fill="none"><circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2"/><path d="M20 20l-3.5-3.5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          <input id="bmQuery" type="text" placeholder="Search business..." />
        </div>
        <div class="bm-list" id="bmList"></div>
      </div>
      <div class="bm-foot">
        <div class="bm-user">
          <div class="avatar"></div>
          <div>
            <div class="lbl">LOGGED AS</div>
            <strong id="bmUserName"></strong>
          </div>
        </div>
        <button class="bm-logout" id="bmLogout" type="button">LOGOUT</button>
      </div>
    </div>
  </div>

  <!-- JS -->
  <script src="js/rail_loader.js"></script>
  <script type="module" src="js/stats-and-reports.js"></script>
  <script src="js/mobil_stats-and-reports.js"></script>
</body>
</html>
