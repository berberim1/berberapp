<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ayarlar</title>

  <!-- Ortak stiller -->
  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="css/rail.css" />
  <link rel="stylesheet" href="css/settings.css" />
</head>
<body>

  <!-- ====== Üst bar ====== -->
  <header class="topbar">
    <div class="topbar__inner">
      <a class="logo" href="index.html">~arat</a>
      <div class="spacer"></div>
      <a id="viewProfileBtn" class="btn btn--ghost" href="profile.html">Profilimi Gör</a>
      <button id="saveBtn" class="btn btn--success" disabled>Kaydet</button>
    </div>
  </header>

  <!-- ====== Dinamik bar-menu mount noktası ====== -->
  <div id="bar-menu"></div>

  <!-- ====== SAYFA İÇERİĞİ ====== -->
  <main class="page">
    <h1 class="page__title">Ayarlar</h1>

    <!-- İşletme Bilgileri -->
    <section class="card">
      <h2 class="card__title">İşletme Bilgileri</h2>

      <!-- 3 sütun x 2 satır -->
      <div class="grid-3x2">
        <label class="field">
          <span>Salon adı (sitede görünen ad)</span>
          <input id="bizName" class="input" placeholder="Örn. Barber Abdullah" />
        </label>

        <label class="field">
          <span>Konum (Google Harita URL – opsiyonel)</span>
          <input id="mapUrl" class="input" placeholder="https://maps.app.goo.gl/..." />
        </label>

        <label class="field">
          <span>Bina No</span>
          <input id="buildingNo" class="input" placeholder="Örn. 12" />
        </label>

        <label class="field">
          <span>İl</span>
          <select id="city" class="input"></select>
        </label>

        <label class="field">
          <span>İlçe</span>
          <select id="district" class="input" disabled></select>
        </label>

        <label class="field">
          <span>Mahalle</span>
          <select id="hood" class="input" disabled></select>
        </label>
      </div>
    </section>

    <!-- Hakkımızda & İletişim -->
    <section class="card">
      <h2 class="card__title">Hakkımızda & İletişim</h2>
      <p class="muted">Profil sayfanızda görünecek kısa tanıtım metni ve müşterilerin sizi arayabileceği telefon numarası.</p>

      <div class="grid-3x2">
        <label class="field" style="grid-column: 1 / -1;">
          <span>Hakkımızda</span>
          <textarea id="aboutText" class="input" rows="5" maxlength="800" placeholder="Kendinizi ve dükkanınızı anlatın. Örn: 10 yıllık tecrübe, özel kesimler, steril ortam..."></textarea>
          <div class="hint">En fazla 800 karakter.</div>
        </label>

        <label class="field">
          <span>İletişim No</span>
          <input id="contactPhone" class="input" inputmode="tel" placeholder="5xx xxx xx xx" />
          <div class="hint">Müşteriler bu numaradan size ulaşır. 10 haneli telefon numaranızı giriniz.</div>
        </label>

        <!-- İsteğe bağlı: Boş alan dengeleme -->
        <div></div><div></div>
      </div>
    </section>

    <!-- Dükkan Saatleri -->
    <section class="card" id="bizHoursCard">
      <div class="card__titlebar">
        <h2 class="card__title">Dükkan Saatleri</h2>
        <div class="muted">Müşteriler bu saatler içinde randevu alabilir.</div>
      </div>

      <!-- hızlı aksiyonlar (JS ile sonra bağlanacak) -->
      <div class="toolbar" style="display:flex; gap:8px; justify-content:flex-end; margin-bottom:8px;">
        <button id="bhCopyWeekdays" class="btn">Hafta içini eşitle</button>
        <button id="bhCopyToAll" class="btn">Pzt ayarını hepsine kopyala</button>
        <button id="bhSetSundayClosed" class="btn">Pazar kapalı</button>
      </div>

      <!-- Saatler grid’i -->
      <div class="grid" id="bizHours" style="gap:10px;">
        <!-- Şablon satır: Gün | [Kapalı] | 09:00 — 20:00 -->
        <!-- Pazartesi -->
        <div class="grid" data-day="mon" style="grid-template-columns: 140px 100px 1fr 14px 1fr; align-items:center; gap:12px;">
          <div class="field" style="margin:0;">
            <label style="margin:0; font-weight:900;">Pazartesi</label>
          </div>
          <label class="field" style="display:flex; align-items:center; gap:8px; margin:0;">
            <input id="bhClosed-mon" type="checkbox" />
            <span>Kapalı</span>
          </label>
          <input id="bhOpen-mon" class="input" type="time" value="09:00" />
          <div style="height:1px; background:#e5e7eb;"></div>
          <input id="bhClose-mon" class="input" type="time" value="20:00" />
        </div>

        <!-- Salı -->
        <div class="grid" data-day="tue" style="grid-template-columns: 140px 100px 1fr 14px 1fr; align-items:center; gap:12px;">
          <div class="field" style="margin:0;"><label style="margin:0; font-weight:900;">Salı</label></div>
          <label class="field" style="display:flex; align-items:center; gap:8px; margin:0;">
            <input id="bhClosed-tue" type="checkbox" />
            <span>Kapalı</span>
          </label>
          <input id="bhOpen-tue" class="input" type="time" value="09:00" />
          <div style="height:1px; background:#e5e7eb;"></div>
          <input id="bhClose-tue" class="input" type="time" value="20:00" />
        </div>

        <!-- Çarşamba -->
        <div class="grid" data-day="wed" style="grid-template-columns: 140px 100px 1fr 14px 1fr; align-items:center; gap:12px;">
          <div class="field" style="margin:0;"><label style="margin:0; font-weight:900;">Çarşamba</label></div>
          <label class="field" style="display:flex; align-items:center; gap:8px; margin:0;">
            <input id="bhClosed-wed" type="checkbox" />
            <span>Kapalı</span>
          </label>
          <input id="bhOpen-wed" class="input" type="time" value="09:00" />
          <div style="height:1px; background:#e5e7eb;"></div>
          <input id="bhClose-wed" class="input" type="time" value="20:00" />
        </div>

        <!-- Perşembe -->
        <div class="grid" data-day="thu" style="grid-template-columns: 140px 100px 1fr 14px 1fr; align-items:center; gap:12px;">
          <div class="field" style="margin:0;"><label style="margin:0; font-weight:900;">Perşembe</label></div>
          <label class="field" style="display:flex; align-items:center; gap:8px; margin:0;">
            <input id="bhClosed-thu" type="checkbox" />
            <span>Kapalı</span>
          </label>
          <input id="bhOpen-thu" class="input" type="time" value="09:00" />
          <div style="height:1px; background:#e5e7eb;"></div>
          <input id="bhClose-thu" class="input" type="time" value="20:00" />
        </div>

        <!-- Cuma -->
        <div class="grid" data-day="fri" style="grid-template-columns: 140px 100px 1fr 14px 1fr; align-items:center; gap:12px;">
          <div class="field" style="margin:0;"><label style="margin:0; font-weight:900;">Cuma</label></div>
          <label class="field" style="display:flex; align-items:center; gap:8px; margin:0;">
            <input id="bhClosed-fri" type="checkbox" />
            <span>Kapalı</span>
          </label>
          <input id="bhOpen-fri" class="input" type="time" value="09:00" />
          <div style="height:1px; background:#e5e7eb;"></div>
          <input id="bhClose-fri" class="input" type="time" value="20:00" />
        </div>

        <!-- Cumartesi -->
        <div class="grid" data-day="sat" style="grid-template-columns: 140px 100px 1fr 14px 1fr; align-items:center; gap:12px;">
          <div class="field" style="margin:0;"><label style="margin:0; font-weight:900;">Cumartesi</label></div>
          <label class="field" style="display:flex; align-items:center; gap:8px; margin:0;">
            <input id="bhClosed-sat" type="checkbox" />
            <span>Kapalı</span>
          </label>
          <input id="bhOpen-sat" class="input" type="time" value="09:00" />
          <div style="height:1px; background:#e5e7eb;"></div>
          <input id="bhClose-sat" class="input" type="time" value="20:00" />
        </div>

        <!-- Pazar -->
        <div class="grid" data-day="sun" style="grid-template-columns: 140px 100px 1fr 14px 1fr; align-items:center; gap:12px;">
          <div class="field" style="margin:0;"><label style="margin:0; font-weight:900;">Pazar</label></div>
          <label class="field" style="display:flex; align-items:center; gap:8px; margin:0;">
            <input id="bhClosed-sun" type="checkbox" checked />
            <span>Kapalı</span>
          </label>
          <input id="bhOpen-sun" class="input" type="time" value="10:00" />
          <div style="height:1px; background:#e5e7eb;"></div>
          <input id="bhClose-sun" class="input" type="time" value="18:00" />
        </div>
      </div>

      <p class="muted" style="margin-top:8px;">
        Not: Saat alanları şimdilik örnek değerlerle dolduruldu. Bir sonraki adımda <strong>Kaydet</strong> akışına ve
        “hepsine uygula” butonlarına JS bağlayacağız.
      </p>
    </section>

    <!-- Görseller -->
    <section class="card">
      <h2 class="card__title">Görseller</h2>
      <p class="muted">Aşağıdaki üç alana <strong>birden fazla</strong> görsel ekleyebilirsiniz.</p>

      <div class="grid3">
        <!-- Kapak -->
        <div class="uploader">
          <div class="uploader__hd">
            <div>
              <strong>Kapak</strong>
              <div class="muted">Anasayfa kartlarında görünen ana görseller</div>
            </div>
            <button class="btn" data-upload="cover">Yükle</button>
          </div>
          <input type="file" accept="image/*" hidden data-input="cover" multiple />
          <div id="coverThumbs" class="thumbs"></div>
        </div>

        <!-- Salon & Profil -->
        <div class="uploader">
          <div class="uploader__hd">
            <div>
              <strong>Salon & Profil</strong>
              <div class="muted">Dükkanınız, siz veya personeliniz</div>
            </div>
            <button class="btn" data-upload="salon">Yükle</button>
          </div>
          <input type="file" accept="image/*" hidden data-input="salon" multiple />
          <div id="salonThumbs" class="thumbs"></div>
        </div>

        <!-- Servis & Model -->
        <div class="uploader">
          <div class="uploader__hd">
            <div>
              <strong>Servis & Model</strong>
              <div class="muted">Hizmet örneği / saç modeli</div>
            </div>
            <button class="btn" data-upload="model">Yükle</button>
          </div>
          <input type="file" accept="image/*" hidden data-input="model" multiple />
          <div id="modelThumbs" class="thumbs"></div>
        </div>
      </div>
    </section>

    <!-- Hizmetler -->
    <section class="card">
      <div class="card__titlebar">
        <h2 class="card__title">Hizmetler & Ücretler</h2>
        <button id="openPicker" class="btn">Hizmetleri Seç</button>
      </div>

      <!-- ÖNERİLENLER chip barı -->
      <div id="svcSuggest" class="svc-suggest"></div>

      <div class="table table--compact">
        <div class="thead">
          <div class="th" style="width:36px">#</div>
          <div class="th">Hizmet adı</div>
          <div class="th" style="width:120px">Süre (dk)</div>
          <div class="th" style="width:120px">Ücret (₺)</div>
          <div class="th" style="width:160px">İşlem</div>
        </div>
        <div id="serviceList" class="tbody">
          <!-- settings.js render edecektir -->
        </div>
      </div>

      <div class="toolbar">
        <button id="addQuick" class="btn">+ Hızlı satır ekle</button>
      </div>
    </section>

  </main>

  <!-- ====== Hizmet Picker Modali ====== -->
  <div id="picker" class="picker-ov" aria-hidden="true">
    <div class="picker" role="dialog" aria-modal="true" aria-labelledby="pickerTtl">
      <div class="picker__hd">
        <div class="ttl" id="pickerTtl">Hizmet Kütüphanesi</div>
        <button class="btn btn--ghost" data-close>✕</button>
      </div>
      <div class="picker__ct">
        <input id="pickerSearch" class="input" placeholder="Hizmet ara..." />
        <div id="pickedChips" class="chips"></div>
        <div id="pickerList" class="pick-list"></div>
      </div>
      <div class="picker__ft">
        <button id="savePicked" class="btn btn--primary">Seçilenleri Kaydet (0)</button>
      </div>
    </div>
  </div>

  <!-- ====== Toast ====== -->
  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <!-- ====== Scriptler ====== -->

  <!-- bar-menu mount: bar-menu.html içeriğini yükle -->
  <script>
    (async () => {
      try {
        const res = await fetch("bar-menu.html", { cache: "no-store" });
        const html = await res.text();
        const doc = new DOMParser().parseFromString(html, "text/html");

        // 1) bar-menu'ye özel stil
        const style = doc.querySelector("#bar-menu-css");
        if (style && !document.getElementById("bar-menu-css")) {
          document.head.appendChild(style.cloneNode(true));
        }

        // 2) nav.rail mount
        const nav = doc.querySelector("nav.rail");
        if (nav) document.getElementById("bar-menu").appendChild(nav.cloneNode(true));

        // 3) sb-overlay/modal body'e
        const sbOverlay = doc.querySelector("#sbOverlay");
        if (sbOverlay && !document.getElementById("sbOverlay")) {
          document.body.appendChild(sbOverlay.cloneNode(true));
        }
      } catch (e) {
        console.warn("bar-menu mount hatası:", e);
      }
    })();
  </script>

  <!-- rail davranışları (aktif menü, modal, logout) -->
  <script type="module" src="js/rail-mount.js"></script>

  <!-- Sayfa js (Firestore vs.) -->
  <script type="module" src="js/settings.js?v=7"></script>

</body>
</html>
